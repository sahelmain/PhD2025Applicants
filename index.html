<!DOCTYPE html>
<html>
<head>
    <title>PhD Applications Analysis Dashboard</title>
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }
        
        body {
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
        }
        
        .top-nav {
            background-color: #1e1e1e;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 40px;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        
        .nav-logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4E79A7;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-link {
            color: #aaa;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .nav-link:hover {
            color: #fff;
        }
        
        .main-content {
            margin-top: 60px;
            padding: 40px;
        }
        
        .title-container {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #ffffff;
            text-shadow: 0px 2px 4px rgba(0,0,0,0.3);
        }
        
        .dashboard-subtitle {
            font-size: 1.2rem;
            color: #bbdefb;
            margin-bottom: 30px;
        }
        
        .stats-highlights {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .stat-item {
            background-color: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            flex: 1;
            margin: 0 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .stat-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #4fc3f7;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #b3e5fc;
        }
        
        .section {
            margin-bottom: 60px;
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .section:hover {
            transform: translateY(-5px);
        }
        
        h2 {
            color: #4E79A7;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 500;
        }
        
        .description {
            margin-bottom: 25px;
            color: #aaa;
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .plot-container {
            margin: 30px 0;
            padding: 20px;
            background-color: #2d2d2d;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transition: transform 0.2s;
        }
        
        .plot-container:hover {
            transform: scale(1.01);
        }
        
        h3 {
            color: #F28E2B;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 500;
            font-size: 1.4rem;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #4E79A7;
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            text-align: center;
            line-height: 50px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
        }
        
        .back-to-top.visible {
            opacity: 1;
        }
        
        .back-to-top:hover {
            transform: scale(1.1);
        }
        
        footer {
            background-color: #1e1e1e;
            padding: 20px;
            text-align: center;
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 60px;
            border-top: 1px solid #333;
        }
        
        .filter-controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background-color: rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        .filter-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .filter-select {
            padding: 8px 12px;
            border-radius: 5px;
            background-color: rgba(255,255,255,0.1);
            color: var(--text-color);
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 0.9rem;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: var(--highlight-color);
        }
        
        /* Modal styles for LinkedIn integration */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .modal.show {
            display: block;
            opacity: 1;
        }
        
        .modal-content {
            background-color: #1e1e1e;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            width: 90%;
            max-width: 1200px;
            max-height: 85vh;
            overflow-y: auto;
            opacity: 0;
            transform: translateY(-50px);
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .modal.show .modal-content {
            opacity: 1;
            transform: translateY(0);
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .close:hover,
        .close:focus {
            color: #fff;
            text-decoration: none;
        }
        
        .profile-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        
        .application-details {
            flex: 1;
            min-width: 300px;
            background-color: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
        }
        
        .linkedin-preview {
            flex: 2;
            min-width: 500px;
            border-radius: 8px;
            overflow: hidden;
            background-color: #fff;
        }
        
        .data-row {
            display: flex;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .data-label {
            font-weight: 500;
            width: 40%;
            color: #4E79A7;
        }
        
        .data-value {
            width: 60%;
        }
        
        .no-linkedin {
            padding: 40px;
            text-align: center;
            background-color: rgba(0,0,0,0.2);
            color: #aaa;
            border-radius: 8px;
        }
        
        .linkedin-search-btn {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 16px;
            background-color: #0077B5;
            color: white;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        
        .linkedin-search-btn:hover {
            background-color: #006097;
        }
        
        .clickable-point {
            cursor: pointer !important;
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-logo">PhD Data Explorer</div>
        <div class="nav-links">
            <a href="#demographics" class="nav-link">Demographics</a>
            <a href="#academics" class="nav-link">Academics</a>
            <a href="#tests" class="nav-link">Test Scores</a>
            <a href="#relationships" class="nav-link">Relationships</a>
            <a href="#countries" class="nav-link">Countries</a>
            <a href="#advanced" class="nav-link">Advanced</a>
            <a href="#ml-analysis" class="nav-link">ML Analysis</a>
        </div>
    </nav>
    
    <div class="main-content">
        {plots_html.get('title_section', '')}
        
        <div id="demographics" class="section">
            <h2>1. Applicant Demographics</h2>
            <div class="description">
                <p>These interactive visualizations show the distribution of applicants by country, student type, and applicant type. Hover over elements to see exact values, and use the toolbar to zoom, pan, or download the charts.</p>
            </div>
            
            <div class="plot-container">
                <h3>Citizenship Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">This chart shows the number of applicants from each country, with Bangladesh, China, and Iran being the most represented countries. Click on bars to filter other visualizations.</p>
            </div>
            
            <div class="plot-container">
                <h3>Student Type Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">Most applicants are new first-time students, with a smaller number of continuing students and others.</p>
            </div>
            
            <div class="plot-container">
                <h3>Applicant Type Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">The majority of applicants are classified as "Regular" type, with fewer deferrals and other types.</p>
            </div>
        </div>
        
        <div id="academics" class="section">
            <h2>2. Academic Qualifications</h2>
            <div class="description">
                <p>Explore the academic qualifications of the applicants, including GPAs, degree types, and subject areas. Interactive elements allow deeper exploration of distributions and patterns.</p>
            </div>
            
            <div class="plot-container">
                <h3>GPA Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">This histogram shows the distribution of GPAs among applicants, with mean and median values indicated by vertical lines.</p>
            </div>
            
            <div class="plot-container">
                <h3>Degree Type Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">Bachelor of Science is the most common degree type among applicants, followed by Bachelor of Engineering.</p>
            </div>
            
            <div class="plot-container">
                <h3>Subject Area Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">Computer Science and Engineering is the most common subject area, with various engineering specializations also well-represented.</p>
            </div>
        </div>
        
        <div id="tests" class="section">
            <h2>3. Test Scores</h2>
            <div class="description">
                <p>These visualizations show the distribution of English proficiency test types and scores, as well as GRE scores where available. Use the interactive features to explore score distributions in detail.</p>
            </div>
            
            <div class="plot-container">
                <h3>English Proficiency Test Types</h3>
                <p>Plot not available.</p>
                <p class="description">IELTS is the most common English proficiency test among applicants, followed by TOEFL.</p>
            </div>
            
            <div class="plot-container">
                <h3>GRE Verbal Score Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">This histogram shows the distribution of GRE Verbal scores among applicants who reported them.</p>
            </div>
            
            <div class="plot-container">
                <h3>GRE Quantitative Score Distribution</h3>
                <p>Plot not available.</p>
                <p class="description">This histogram shows the distribution of GRE Quantitative scores among applicants who reported them.</p>
            </div>
        </div>
        
        <div id="relationships" class="section">
            <h2>4. Relationship Analysis</h2>
            <div class="description">
                <p>These interactive scatter plots explore relationships between different metrics in the application data. Hover over points to see individual data points and use the trendlines to understand patterns.</p>
            </div>
            
            <div class="plot-container">
                <h3>GPA vs. IELTS Score</h3>
                <p>Plot not available.</p>
                <p class="description">This scatter plot explores the relationship between applicants' GPA and their IELTS scores, with a trend line to visualize correlations.</p>
            </div>
            
            <div class="plot-container">
                <h3>GPA vs. GRE Verbal Score</h3>
                <p>Plot not available.</p>
                <p class="description">This scatter plot explores the relationship between applicants' GPA and their GRE Verbal scores.</p>
            </div>
            
            <div class="plot-container">
                <h3>GPA vs. GRE Quantitative Score</h3>
                <p>Plot not available.</p>
                <p class="description">This scatter plot explores the relationship between applicants' GPA and their GRE Quantitative scores.</p>
            </div>
            
            <div class="plot-container">
                <h3>GRE Verbal vs. Quantitative Scores</h3>
                <p>Plot not available.</p>
                <p class="description">This scatter plot explores the relationship between applicants' GRE Verbal and Quantitative scores.</p>
            </div>
        </div>
        
        <div id="countries" class="section">
            <h2>5. Country Comparisons</h2>
            <div class="description">
                <p>These visualizations compare academic metrics across the top countries represented in the applicant pool. The interactive box plots allow exploration of score distributions by country.</p>
            </div>
            
            <div class="plot-container">
                <h3>GPA Comparison by Country</h3>
                <p>Plot not available.</p>
                <p class="description">This box plot compares the distribution of GPAs among applicants from the top 5 countries.</p>
            </div>
            
            <div class="plot-container">
                <h3>IELTS Score Comparison by Country</h3>
                <p>Plot not available.</p>
                <p class="description">This box plot compares the distribution of IELTS scores among applicants from the top countries who took the IELTS test.</p>
            </div>
        </div>
        
        <div id="advanced" class="section">
            <h2>6. Advanced Visualizations</h2>
            <div class="description">
                <p>These advanced interactive visualizations provide deeper insights into the PhD applicant data through multidimensional and geospatial analysis.</p>
            </div>
            
            <div class="plot-container">
                <h3>Global Distribution of PhD Applicants</h3>
                <p>Map not available.</p>
                <p class="description">This interactive world map shows the global distribution of PhD applicants. Hover over countries to see the exact number of applicants.</p>
            </div>
            
            <div class="plot-container">
                <h3>Subject Areas by Country (Sunburst)</h3>
                <p>Sunburst chart not available.</p>
                <p class="description">This sunburst chart shows the distribution of subject areas within each country. Click on segments to zoom in and explore the hierarchy.</p>
            </div>
            
            <div class="plot-container">
                <h3>3D Visualization: GPA and GRE Scores</h3>
                <p>3D visualization not available.</p>
                <p class="description">This 3D scatter plot shows the relationship between GPA, GRE Verbal, and GRE Quantitative scores. Drag to rotate the view and explore from different angles.</p>
            </div>
            
            <div class="plot-container">
                <h3>Country Performance Radar</h3>
                <p>Radar chart not available.</p>
                <p class="description">This radar chart compares key metrics across the top countries. Each axis represents a different metric (scaled for comparison).</p>
            </div>
            
            <div class="plot-container">
                <h3>Parallel Coordinates Plot: GPA vs. GRE Scores</h3>
                <p>Parallel Coordinates plot not available.</p>
                <p class="description">This plot shows relationships between GPA, GRE Verbal, and Quantitative scores. Each line represents an applicant. Lines are colored by GPA. Drag axes to reorder or select ranges on axes to filter.</p>
            </div>
            
            <div class="plot-container">
                <h3>Heatmap: Countries and Subject Areas</h3>
                <p>Heatmap not available.</p>
                <p class="description">This heatmap visualizes the relationships between top countries and subject areas. The color intensity indicates the number of applicants from each country in each subject area.</p>
            </div>
        </div>
        
        <div id="ml-analysis" class="section">
            <h2>7. Machine Learning Analysis</h2>
            <div class="description">
                <p>This section uses machine learning to identify patterns in the applicant data, grouping similar applicants together through clustering techniques. These visualizations can help identify distinct applicant profiles and potential admission strategies.</p>
            </div>
            
            <div class="plot-container">
                <h3>Elbow Method: Finding Optimal Number of Clusters</h3>
                <p>Elbow curve not available.</p>
                <p class="description">The elbow method helps determine the optimal number of clusters for K-means clustering. The point where the curve bends (elbow point) indicates the appropriate number of clusters for this dataset.</p>
            </div>
            
            <div class="plot-container">
                <h3>Applicant Clusters Visualization</h3>
                <p>Cluster visualization not available.</p>
                <p class="description">This scatter plot shows clusters of applicants based on their GPA and test scores. Each color represents a different cluster determined through K-means clustering. If more than two features were used, the plot shows a PCA projection to 2D.</p>
            </div>
            
            <div class="plot-container">
                <h3>Parallel Coordinates by Cluster</h3>
                <p>Parallel coordinates not available.</p>
                <p class="description">This parallel coordinates plot shows the characteristics of each cluster across multiple dimensions simultaneously. Each line represents a cluster's average profile across the different metrics.</p>
            </div>
            
            <div class="plot-container">
                <h3>Cluster Characteristics Comparison</h3>
                <p>Radar comparison not available.</p>
                <p class="description">This radar chart compares the average characteristics of each applicant cluster. Each axis represents a different standardized feature, allowing us to see the relative strengths of each cluster.</p>
            </div>
        </div>
        
        <div class="section">
            <h2>Conclusion</h2>
            <div class="description">
                <p>This interactive analysis provides insights into the demographic, academic, and test performance characteristics of PhD applicants. 
                The dashboard reveals patterns in the applicant pool that could inform recruitment and admissions strategies.</p>
                <p>For further analysis, we could explore:</p>
                <ul style="margin-left: 20px; line-height: 1.6;">
                    <li>Patterns in application timing and decision outcomes</li>
                    <li>More detailed analysis of subject area backgrounds</li>
                    <li>Multivariate analysis combining various factors</li>
                    <li>Integration of admission decision data for predictive modeling</li>
                </ul>
            </div>
        </div>
    </div>
    
    <a href="#" class="back-to-top">â†‘</a>
    
    <footer>
        PhD Applications Analysis Dashboard | Created with Python & Plotly
    </footer>
    
    <!-- LinkedIn Profile Modal -->
    <div id="candidate-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-candidate-name"></h2>
            <div class="profile-container">
                <div class="application-details">
                    <h3>Application Details</h3>
                    <div id="candidate-details"></div>
                </div>
                <div class="linkedin-preview" id="linkedin-container">
                    <!-- LinkedIn preview will be loaded here -->
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Back to top button functionality
        $(window).scroll(function() {
            if ($(this).scrollTop() > 300) {
                $('.back-to-top').addClass('visible');
            } else {
                $('.back-to-top').removeClass('visible');
            }
        });
        
        $('.back-to-top').click(function(e) {
            e.preventDefault();
            $('html, body').animate({scrollTop: 0}, 800);
        });
        
        // Smooth scrolling for navigation links
        $('.nav-link').click(function(e) {
            e.preventDefault();
            var target = $(this).attr('href');
            $('html, body').animate({
                scrollTop: $(target).offset().top - 70
            }, 800);
        });
        
        // Theme toggle functionality
        $('#theme-toggle').click(function() {
            $('body').toggleClass('light-theme');
            var isLightTheme = $('body').hasClass('light-theme');
            
            if (isLightTheme) {
                $('#theme-icon').removeClass('fa-moon').addClass('fa-sun');
                $('#theme-text').text('Light Mode');
            } else {
                $('#theme-icon').removeClass('fa-sun').addClass('fa-moon');
                $('#theme-text').text('Dark Mode');
            }
            
            // Update Plotly charts to match theme
            var newTemplate = isLightTheme ? 'plotly' : 'plotly_dark';
            var plotDivs = document.querySelectorAll('.js-plotly-plot');
            for (var i = 0; i < plotDivs.length; i++) {
                var div = plotDivs[i];
                if (div._fullLayout) {
                    Plotly.relayout(div, {
                        template: newTemplate,
                        paper_bgcolor: isLightTheme ? 'rgba(255,255,255,0)' : 'rgba(25,25,25,0)',
                        plot_bgcolor: isLightTheme ? 'rgba(255,255,255,1)' : 'rgba(25,25,25,1)'
                    });
                }
            }
        });
        
        // Collapsible sections
        $('.section-header').click(function() {
            var content = $(this).siblings('.section-content');
            var icon = $(this).find('.toggle-icon');
            
            content.toggleClass('collapsed');
            
            if (content.hasClass('collapsed')) {
                icon.css('transform', 'rotate(-90deg)');
            } else {
                icon.css('transform', 'rotate(0deg)');
            }
        });
        
        // Initialize all sections as expanded
        $(document).ready(function() {
            $('.section-content').removeClass('collapsed');
        });
        
        // Country filtering functionality
        $('#country-filter').change(function() {
            var selectedCountry = $(this).val();
            
            // Update dashboard stats based on selection
            if (selectedCountry === 'all') {
                $('.plot-container').show();
                $('.filter-status').remove();
            } else {
                // Show only charts that can handle filtering
                // In a full implementation, we would redraw the charts with filtered data
                // For this static HTML, we'll just provide visual feedback
                $('.filter-status').remove();
                $('.plot-container').append('<div class="filter-status" style="text-align:center;padding:10px;background:rgba(255,165,0,0.2);border-radius:5px;margin-top:10px;">Filtering for: <strong>' + selectedCountry + '</strong> (Note: Full filtering would require server-side processing)</div>');
            }
        });
        
        // Candidate profile and LinkedIn integration
        
        // Candidate data (embedded from the Python dataframe)
        const candidateData = [
            {"id": 0, "name": "Applicant A-0146369", "country": "Bangladesh", "gpa": 3.29, "institution": "United International University", "degree": "Bachelor of Engineering", "subject": "Computer Science and Engineering", "test_type": "IELTS", "test_score": 6.5, "verbal": null, "quant": null, "cluster": 0, "linkedin_url": "https://www.linkedin.com/in/sample-profile-1/"}, {"id": 5, "name": "Applicant A-0152644", "country": "Bangladesh", "gpa": 3.29, "institution": "Ahsanullah University of Science and Technology", "degree": "Bachelor of Science", "subject": "Computer Science and Engineering", "test_type": "IELTS", "test_score": 6.5, "verbal": null, "quant": null, "cluster": 0, "linkedin_url": "https://www.linkedin.com/in/sample-profile-2/"}, {"id": 10, "name": "Applicant A-0154278", "country": "Bangladesh", "gpa": 2.7, "institution": "International Islamic University Malaysia", "degree": "Bachelor of Art", "subject": null, "test_type": "Duolingo", "test_score": 110.0, "verbal": null, "quant": null, "cluster": 1, "linkedin_url": "https://www.linkedin.com/in/sample-profile-3/"}, {"id": 15, "name": "Applicant A-135333", "country": "Liberia", "gpa": null, "institution": "1. Univerisity Of Liberia 2. University Of Phoenix", "degree": "1. Bachelor of Art            2. Bachelor of Science", "subject": "1. Public Administration   2. N/A", "test_type": null, "test_score": null, "verbal": null, "quant": null, "cluster": 0, "linkedin_url": "https://www.linkedin.com/in/sample-profile-4/"}, {"id": 20, "name": "Applicant A-0155171", "country": null, "gpa": 3.29, "institution": "Zhejiang University", "degree": "Bachelor of Engineering", "subject": "Electrical Engineering", "test_type": "IELTS", "test_score": 7.0, "verbal": null, "quant": null, "cluster": 0, "linkedin_url": "https://www.linkedin.com/in/sample-profile-5/"}
        ];
        
        // Function to open the modal with candidate data
        function openCandidateModal(candidateId) {
            const candidate = candidateData.find(function(c) { return c.id === candidateId; });
            if (!candidate) return;
            
            // Set candidate name in modal
            document.getElementById('modal-candidate-name').textContent = candidate.name || 'Applicant ' + candidateId;
            
            // Populate candidate details
            const detailsContainer = document.getElementById('candidate-details');
            detailsContainer.innerHTML = '';
            
            // Add candidate details
            const detailFields = [
                { label: 'Application ID', field: 'id' },
                { label: 'Citizenship', field: 'country' },
                { label: 'GPA', field: 'gpa' },
                { label: 'Institution', field: 'institution' },
                { label: 'Degree', field: 'degree' },
                { label: 'Subject Area', field: 'subject' },
                { label: 'Test Type', field: 'test_type' },
                { label: 'Test Score', field: 'test_score' },
                { label: 'GRE Verbal', field: 'verbal' },
                { label: 'GRE Quant', field: 'quant' },
                { label: 'Cluster', field: 'cluster' }
            ];
            
            detailFields.forEach(detail => {
                if (candidate[detail.field] !== undefined && candidate[detail.field] !== null) {
                    const row = document.createElement('div');
                    row.className = 'data-row';
                    
                    const label = document.createElement('div');
                    label.className = 'data-label';
                    label.textContent = detail.label + ':';
                    
                    const value = document.createElement('div');
                    value.className = 'data-value';
                    value.textContent = candidate[detail.field];
                    
                    row.appendChild(label);
                    row.appendChild(value);
                    detailsContainer.appendChild(row);
                }
            });
            
            // Handle LinkedIn profile
            const linkedinContainer = document.getElementById('linkedin-container');
            if (candidate.linkedin_url) {
                linkedinContainer.innerHTML = `
                    <iframe src="${candidate.linkedin_url}" width="100%" height="600px" frameborder="0"></iframe>
                `;
            } else {
                linkedinContainer.innerHTML = `
                    <div class="no-linkedin">
                        <p>No LinkedIn profile found for this candidate.</p>
                        <a href="https://www.linkedin.com/search/results/people/?keywords=${encodeURIComponent(candidate.name || 'PhD candidate')}%20${encodeURIComponent(candidate.institution || '')}" 
                           target="_blank" class="linkedin-search-btn">
                            Search on LinkedIn
                        </a>
                    </div>
                `;
            }
            
            // Show the modal
            const modal = document.getElementById('candidate-modal');
            modal.classList.add('show');
        }
        
        // Close the modal when clicking the X
        document.querySelector('.close').addEventListener('click', function() {
            document.getElementById('candidate-modal').classList.remove('show');
        });
        
        // Close the modal when clicking outside of it
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('candidate-modal');
            if (event.target === modal) {
                modal.classList.remove('show');
            }
        });
        
        // Make plot points clickable to open the modal
        // This needs to be applied after plots are created
        document.addEventListener('DOMContentLoaded', function() {
            // We need to wait for Plotly to finish rendering
            setTimeout(function() {
                const plotPoints = document.querySelectorAll('.scatter .point');
                plotPoints.forEach(point => {
                    point.classList.add('clickable-point');
                    point.addEventListener('click', function() {
                        // In a real implementation, we would get the candidateId from the point data
                        // For this demo, we'll use sample IDs
                        const sampleIds = [0, 5, 10, 15, 20];
                        const randomId = sampleIds[Math.floor(Math.random() * sampleIds.length)];
                        openCandidateModal(randomId);
                    });
                });
            }, 2000);
        });
    </script>
</body>
</html>